<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Reports
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-accordion-group (ionChange)="handleAccordionChange($event)">
    <ion-accordion *ngFor="let report of reports" [value]="report.id">
      <ion-item slot="header">
        <ion-label>{{ report.name }}</ion-label>
      </ion-item>

      <div slot="content" *ngIf="report.preview">
        <h2>{{ report.name }} - Filters</h2>

        
        <!-- START DATE -->
        <ion-item id="{{ 'report-start-' + report.id }}" lines="full">
          <ion-label position="fixed">Start Date</ion-label>
          <ion-input
            readonly
            [value]="report.filters.startDateDisplay"
            placeholder="Select date">
          </ion-input>
        </ion-item>

        <ion-modal
          trigger="{{ 'report-start-' + report.id }}"
          [keepContentsMounted]="true"
          cssClass="report-datetime-modal">
          <ng-template>
            <ion-content>
              <ion-datetime
                presentation="date"
                [value]="report.filters.startDate"
                show-default-buttons="true"
                (ionChange)="onStartDateChange(report, $event)">
              </ion-datetime>
            </ion-content>
          </ng-template>
        </ion-modal>

        <!-- END DATE -->
        <ion-item id="{{ 'report-end-' + report.id }}" lines="full">
          <ion-label position="fixed">End Date</ion-label>
          <ion-input
            readonly
            [value]="report.filters.endDateDisplay"
            placeholder="Select date">
          </ion-input>
        </ion-item>

        <ion-modal
          trigger="{{ 'report-end-' + report.id }}"
          [keepContentsMounted]="true"
          cssClass="report-datetime-modal">
          <ng-template>
            <ion-content>
              <ion-datetime
                presentation="date"
                [value]="report.filters.endDate"
                show-default-buttons="true"
                (ionChange)="onEndDateChange(report, $event)">
              </ion-datetime>
            </ion-content>
          </ng-template>
        </ion-modal>

        <!-- TYPE (unchanged layout, only ensure same label position) -->
        <ion-item>
          <ion-label position="fixed">Type</ion-label>
          <ion-select
            [(ngModel)]="report.filters.type"
            interface="popover"
            placeholder="Select type">
            <ion-select-option value="summary">Summary</ion-select-option>
            <ion-select-option value="detailed">Detailed</ion-select-option>
            <ion-select-option value="graph">Graph</ion-select-option>
          </ion-select>
        </ion-item>


        <div style="margin-top: 1em;">
          <p>{{ report.preview }}</p>
        </div>
      </div>
    </ion-accordion>
  </ion-accordion-group>

</ion-content>

<app-footer-bar></app-footer-bar>