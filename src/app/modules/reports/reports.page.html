<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Reports
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card class="chart-card">
    <ion-card-header>
      <ion-card-title>Production Overview</ion-card-title>
      <ion-card-subtitle>Snapshot for the last 6 periods</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <div class="chart-container">
        <canvas #reportChart></canvas>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-accordion-group (ionChange)="handleAccordionChange($event)">
    <ion-accordion *ngFor="let report of reports" [value]="report.id">
      <ion-item slot="header">
        <ion-label>{{ report.name }}</ion-label>
      </ion-item>

      <div slot="content" *ngIf="report.preview">
        <h2>{{ report.name }} - Filters</h2>

        
        <!-- START DATE -->
        <app-date-field-modal
          [triggerId]="'report-start-' + report.id"
          modalCssClass="report-datetime-modal"
          label="Start Date"
          placeholder="Select date"
          [value]="report.filters.startDate"
          [displayValue]="report.filters.startDateDisplay"
          (valueChange)="onStartDateChange(report, $event)">
        </app-date-field-modal>

        <!-- END DATE -->
        <app-date-field-modal
          [triggerId]="'report-end-' + report.id"
          modalCssClass="report-datetime-modal"
          label="End Date"
          placeholder="Select date"
          [value]="report.filters.endDate"
          [displayValue]="report.filters.endDateDisplay"
          (valueChange)="onEndDateChange(report, $event)">
        </app-date-field-modal>

        <!-- TYPE (unchanged layout, only ensure same label position) -->
        <ion-item>
          <ion-label position="fixed">Type</ion-label>
          <ion-select
            [(ngModel)]="report.filters.type"
            interface="popover"
            placeholder="Select type">
            <ion-select-option value="summary">Summary</ion-select-option>
            <ion-select-option value="detailed">Detailed</ion-select-option>
            <ion-select-option value="graph">Graph</ion-select-option>
          </ion-select>
        </ion-item>


        <div style="margin-top: 1em;">
          <p>{{ report.preview }}</p>
        </div>
      </div>
    </ion-accordion>
  </ion-accordion-group>

</ion-content>

<app-footer-bar></app-footer-bar>
